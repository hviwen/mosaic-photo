@tailwind base;
@tailwind components;
@tailwind utilities;

/* Tailwind will replace the legacy SCSS system.
  Keep only minimal compatibility classes while migrating.
*/

:root {
  color-scheme: dark;

  --app-bg: #0b1020;
  --app-fg: #e5e7eb;
  --border-subtle: rgba(255, 255, 255, 0.1);
  --panel-bg: rgba(15, 23, 42, 0.3);
  --panel-bg-strong: rgba(2, 6, 23, 0.3);
  --input-bg: rgba(2, 6, 23, 0.4);
  --canvas-bg: #0b1020;
  --canvas-inner-bg: #0f172a;

  /* Glassmorphism design system (dark) */
  --glass-blur: 14px;
  --glass-radius: 16px;
  --glass-bg: rgba(2, 6, 23, 0.52);
  --glass-bg-weak: rgba(15, 23, 42, 0.35);
  --glass-bg-strong: rgba(2, 6, 23, 0.66);
  --glass-border: rgba(255, 255, 255, 0.14);
  --glass-border-strong: rgba(255, 255, 255, 0.22);
  --glass-highlight: rgba(255, 255, 255, 0.06);
  --glass-shadow-sm: 0 8px 20px rgba(0, 0, 0, 0.28);
  --glass-shadow: 0 18px 40px rgba(0, 0, 0, 0.38);
  --focus-ring: rgba(59, 130, 246, 0.45);
}

html[data-theme="light"] {
  color-scheme: light;

  --app-bg: #f8fafc;
  --app-fg: #0f172a;
  --border-subtle: rgba(15, 23, 42, 0.12);
  --panel-bg: rgba(255, 255, 255, 0.85);
  --panel-bg-strong: rgba(255, 255, 255, 0.92);
  --input-bg: rgba(255, 255, 255, 0.9);
  --canvas-bg: #f1f5f9;
  --canvas-inner-bg: #ffffff;

  /* Glassmorphism design system (light) */
  --glass-blur: 14px;
  --glass-radius: 16px;
  --glass-bg: rgba(255, 255, 255, 0.62);
  --glass-bg-weak: rgba(255, 255, 255, 0.48);
  --glass-bg-strong: rgba(255, 255, 255, 0.78);
  --glass-border: rgba(15, 23, 42, 0.12);
  --glass-border-strong: rgba(15, 23, 42, 0.18);
  --glass-highlight: rgba(255, 255, 255, 0.7);
  --glass-shadow-sm: 0 10px 24px rgba(15, 23, 42, 0.12);
  --glass-shadow: 0 22px 46px rgba(15, 23, 42, 0.16);
  --focus-ring: rgba(59, 130, 246, 0.35);
}

html,
body {
  height: 100%;
}

body {
  margin: 0;
  font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial,
    "Apple Color Emoji", "Segoe UI Emoji";
  background: var(--app-bg);
  color: var(--app-fg);
  transition: background-color 250ms ease, color 250ms ease;
}

/* Accessibility: consistent focus ring */
:where(a, button, input, select, textarea, [role="button"], [tabindex]):focus-visible {
  outline: 2px solid transparent;
  box-shadow: 0 0 0 3px var(--focus-ring);
}

@supports not ((-webkit-backdrop-filter: blur(1px)) or (backdrop-filter: blur(1px))) {
  :root {
    --glass-blur: 0px;
  }
}

@layer components {
  /* Glass surfaces */
  .glass-surface {
    @apply relative overflow-hidden;
    border-radius: var(--glass-radius);
    background-color: var(--glass-bg);
    border: 1px solid var(--glass-border);
    box-shadow: var(--glass-shadow-sm);
    -webkit-backdrop-filter: blur(var(--glass-blur));
    backdrop-filter: blur(var(--glass-blur));
    transition: transform 180ms ease, box-shadow 250ms ease, border-color 250ms ease,
      background-color 250ms ease;
  }

  .glass-surface::before {
    content: "";
    position: absolute;
    inset: 0;
    pointer-events: none;
    background: linear-gradient(135deg, var(--glass-highlight), transparent 55%);
    opacity: 0.9;
  }

  .glass-surface--strong {
    background-color: var(--glass-bg-strong);
  }

  .glass-surface--weak {
    background-color: var(--glass-bg-weak);
  }

  @media (hover: hover) {
    .glass-surface--interactive:hover {
      border-color: var(--glass-border-strong);
      box-shadow: var(--glass-shadow);
      transform: translateY(-1px);
    }
  }

  /* Vuetify drawers (left/right sidebars) */
  .app-drawer.v-navigation-drawer {
    background: transparent !important;
    background-color: transparent !important;
  }

  .app-drawer .v-navigation-drawer__content {
    @apply h-full;
    background-color: var(--glass-bg-strong) !important;
    border-color: var(--glass-border);
    -webkit-backdrop-filter: blur(var(--glass-blur));
    backdrop-filter: blur(var(--glass-blur));
  }

  .app-drawer--left .v-navigation-drawer__content {
    border-right: 1px solid var(--glass-border);
  }

  .app-drawer--right .v-navigation-drawer__content {
    border-left: 1px solid var(--glass-border);
  }

  .app-drawer .v-toolbar {
    background: transparent;
  }

  .app-drawer .v-divider {
    opacity: 1;
    border-color: var(--glass-border);
  }

  /* Vuetify cards/alerts inside drawers -> glassy containers */
  .app-drawer .v-card,
  .app-drawer .v-alert {
    border-radius: var(--glass-radius);
    background-color: var(--glass-bg-weak) !important;
    border: 1px solid var(--glass-border);
    box-shadow: var(--glass-shadow-sm);
    -webkit-backdrop-filter: blur(var(--glass-blur));
    backdrop-filter: blur(var(--glass-blur));
  }

  @media (hover: hover) {
    .app-drawer .v-card:hover {
      border-color: var(--glass-border-strong);
      box-shadow: var(--glass-shadow);
    }
  }

  /* Vuetify buttons: smoother + clearer hover */
  .v-btn {
    transition: transform 180ms ease, background-color 250ms ease, box-shadow 250ms ease,
      color 250ms ease, border-color 250ms ease;
  }

  .v-btn--disabled {
    transform: none;
  }

  @media (hover: hover) {
    .v-btn--variant-text:hover:not(.v-btn--disabled),
    .v-btn--variant-tonal:hover:not(.v-btn--disabled) {
      background-color: color-mix(in srgb, var(--glass-bg-weak) 65%, transparent);
    }

    .v-btn--variant-outlined:hover:not(.v-btn--disabled) {
      border-color: var(--glass-border-strong);
      background-color: color-mix(in srgb, var(--glass-bg-weak) 45%, transparent);
    }
  }

  .app-layout {
    @apply grid h-screen;
    grid-template-columns: 280px 1fr 320px;
  }

  .main-content {
    @apply min-w-0 min-h-0 h-full overflow-hidden flex flex-col;
  }

  .sidebar {
    @apply flex h-screen flex-col border-r border-white/10 bg-slate-950/30;
    background-color: var(--panel-bg-strong);
    border-color: var(--border-subtle);
  }

  .sidebar--right {
    @apply border-l border-r-0;
    border-color: var(--border-subtle);
  }

  .sidebar__header {
    @apply border-b border-white/10 px-4 py-4;
    border-color: var(--border-subtle);
  }

  .sidebar__content {
    @apply flex-1 overflow-auto px-4 py-4;
  }

  .sidebar__footer {
    @apply border-t border-white/10 px-4 py-3;
    border-color: var(--border-subtle);
  }

  .panel-section {
    @apply mb-4 p-4;
    border-radius: var(--glass-radius);
    background-color: var(--glass-bg);
    border: 1px solid var(--glass-border);
    box-shadow: var(--glass-shadow-sm);
    -webkit-backdrop-filter: blur(var(--glass-blur));
    backdrop-filter: blur(var(--glass-blur));
    transition: transform 180ms ease, box-shadow 250ms ease, border-color 250ms ease,
      background-color 250ms ease;
  }

  @media (hover: hover) {
    .panel-section:hover {
      border-color: var(--glass-border-strong);
      box-shadow: var(--glass-shadow);
      transform: translateY(-1px);
    }
  }

  .panel-section__title {
    @apply mb-3 flex items-center gap-2 text-sm font-semibold;
    color: var(--app-fg);
  }

  .panel-section__title svg {
    @apply h-4 w-4;
    color: color-mix(in srgb, var(--app-fg) 78%, transparent);
  }

  .panel-section__content {
    @apply flex flex-col gap-3;
  }

  .hint {
    @apply text-xs text-slate-400;
  }

  html[data-theme="light"] .hint {
    @apply text-slate-600;
  }

  .empty-state {
    @apply flex flex-col items-center justify-center gap-3 rounded-xl border border-white/10 bg-slate-900/20 p-6 text-slate-300;
    background-color: var(--panel-bg);
    border-color: var(--border-subtle);
  }

  html[data-theme="light"] .empty-state {
    @apply text-slate-700;
  }

  .empty-state svg {
    @apply h-12 w-12 text-slate-500;
  }

  .form-row {
    @apply flex flex-col gap-2;
  }

  .form-row--inline {
    @apply flex items-center justify-between gap-3;
  }

  .form-row__value {
    @apply text-xs text-slate-300;
  }

  .label {
    @apply text-xs font-medium text-slate-300;
  }

  html[data-theme="light"] .label {
    @apply text-slate-700;
  }

  .select,
  .input {
    @apply w-full rounded-lg border border-white/10 bg-slate-950/40 px-3 py-2 text-sm text-slate-100 outline-none;
    background-color: var(--input-bg);
    border-color: var(--border-subtle);
    color: var(--app-fg);
  }

  .slider {
    @apply w-full;
  }

  .btn {
    @apply inline-flex items-center justify-center gap-2 rounded-lg px-3 py-2 text-sm font-medium transition;
  }

  .btn--sm {
    @apply px-2 py-1 text-xs;
  }

  .btn--block {
    @apply w-full;
  }

  .btn--primary {
    @apply bg-blue-600 text-white hover:bg-blue-500 disabled:cursor-not-allowed disabled:opacity-50;
  }

  .btn--secondary {
    @apply text-slate-100;
    background-color: color-mix(in srgb, var(--glass-bg-weak) 70%, transparent);
    border: 1px solid var(--glass-border);
  }

  @media (hover: hover) {
    .btn--secondary:hover:not(:disabled) {
      border-color: var(--glass-border-strong);
      background-color: color-mix(in srgb, var(--glass-bg-weak) 85%, transparent);
      box-shadow: var(--glass-shadow-sm);
    }
  }

  .btn--success {
    @apply bg-emerald-600 text-white hover:bg-emerald-500 disabled:cursor-not-allowed disabled:opacity-50;
  }

  .btn--danger {
    @apply bg-rose-600 text-white hover:bg-rose-500;
  }

  .btn--ghost {
    @apply text-slate-300;
    background-color: transparent;
    border: 1px solid transparent;
  }

  @media (hover: hover) {
    .btn--ghost:hover:not(:disabled) {
      background-color: color-mix(in srgb, var(--glass-bg-weak) 55%, transparent);
      border-color: var(--glass-border);
    }
  }

  html[data-theme="light"] .btn--ghost {
    @apply text-slate-700 hover:bg-slate-900/10;
  }

  html[data-theme="light"] .btn--secondary {
    @apply text-slate-900;
  }

  .drop-zone {
    @apply cursor-pointer rounded-xl border-2 border-dashed border-white/15 bg-slate-900/20 p-6 text-center transition;
  }

  .drop-zone--active,
  .drop-zone:hover {
    @apply border-blue-500/70 bg-blue-500/5;
  }

  .drop-zone__icon {
    @apply mx-auto mb-3 h-12 w-12 text-slate-400;
  }

  .drop-zone__title {
    @apply text-sm font-medium text-slate-200;
  }

  .drop-zone__hint {
    @apply mt-1 text-xs text-slate-400;
  }

  .photo-list {
    @apply grid max-h-56 grid-cols-4 gap-2 overflow-auto rounded-lg bg-black/20 p-2;
  }

  .photo-thumb {
    @apply relative aspect-square overflow-hidden rounded-md border-2 border-transparent;
  }

  .photo-thumb--selected {
    @apply border-blue-500;
  }

  .photo-thumb img {
    @apply h-full w-full object-cover;
  }

  .photo-thumb__remove {
    @apply absolute right-1 top-1 hidden h-5 w-5 items-center justify-center rounded-full bg-black/70 text-white;
  }

  .photo-thumb:hover .photo-thumb__remove {
    @apply inline-flex;
  }

  .toast-container {
    @apply fixed bottom-6 right-6 z-50 flex flex-col gap-3;
  }

  .toast {
    @apply flex max-w-sm items-center gap-3 rounded-xl border border-white/10 bg-slate-900/95 px-4 py-3 shadow-xl;
    background-color: var(--glass-bg-strong);
    border-color: var(--glass-border);
    -webkit-backdrop-filter: blur(var(--glass-blur));
    backdrop-filter: blur(var(--glass-blur));
  }

  .toast__message {
    @apply flex-1 text-sm text-slate-100;
    color: var(--app-fg);
  }

  .toast__icon {
    @apply h-5 w-5;
  }

  .toast--success .toast__icon {
    @apply text-emerald-400;
  }

  .toast--error .toast__icon {
    @apply text-rose-400;
  }

  .toast--warning .toast__icon {
    @apply text-amber-400;
  }
}

@layer components {
  .canvas-stage {
    @apply flex flex-1 flex-col overflow-hidden;
    background: var(--canvas-bg);
  }

  .canvas-stage__header {
    @apply flex items-center justify-between gap-3 border-b px-4 py-3;
    border-color: var(--glass-border);
    background-color: color-mix(in srgb, var(--glass-bg-strong) 72%, transparent);
    -webkit-backdrop-filter: blur(var(--glass-blur));
    backdrop-filter: blur(var(--glass-blur));
  }

  .canvas-stage__title {
    @apply flex items-center gap-3 text-sm;
  }

  .canvas-stage__actions {
    @apply flex items-center gap-2;
  }

  .zoom-control {
    @apply flex items-center gap-2;
  }

  .zoom-control__value {
    @apply min-w-[52px] text-center text-xs tabular-nums;
  }

  .canvas-stage__body {
    @apply relative flex-1 overflow-hidden p-4;
  }

  .canvas-stage__body canvas {
    @apply block h-full w-full rounded-xl shadow-xl;
    background: var(--canvas-inner-bg);
    border: 1px solid var(--glass-border);
  }
}
